@if (university) {
<div class="container container-university">
  <!-- University Header Card -->
  <div class="card university-card border-0 shadow position-relative my-4 d-flex flex-column">
    <!-- Banner Image -->
    <div class="university-banner-container">
      <img [src]="university.bannerImage" alt="University Banner" class="university-banner"
        onerror="this.src='images/oxford-university-banner.jpg'">
      <!-- University Logo Overlay -->
      <div class="university-logo-overlay">
        <img [src]="university.logo" alt="University Logo" class="university-logo-large rounded">
      </div>
    </div>

    <div class="card-body p-4 position-relative flex-grow-1">
      <!-- Save College Button -->
      <button class="btn btn-save-college">
        <i class="bi bi-heart-fill"></i>
        Save College
      </button>

      <div class="row align-items-start g-3">
        <!-- University Info -->
        <div class="col-12">
          <div class="row">
            <div class="col-6">
              <h2 class="h1 fw-bold mb-1">{{ university.name }}</h2>
              <p class="h4 mb-0">
                {{ university.location || 'Unknown Location' }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card border-0 shadow mb-4">
    <div class="card-body p-4">
      <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
        <!-- Overview Tab -->
        <li [ngbNavItem]="1">
          <button ngbNavLink>Overview</button>
          <ng-template ngbNavContent>
            <div class="p-4">
              <h3 class="h5 fw-bold mb-3">About {{ university.name }}</h3>
              <p class="text-muted">{{ university.description }}</p>

              <div class="row mt-4">
                <div class="col-md-4">
                  <div class="stat-box">
                    <p class="stat-label text-muted mb-1">Available Courses</p>
                    <p class="stat-value fw-bold h5">{{ university.courses.length || 0 }}</p>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="stat-box">
                    <p class="stat-label text-muted mb-1">Students</p>
                    <p class="stat-value fw-bold h5">{{ university.studentCount | number }}</p>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="stat-box">
                    <p class="stat-label text-muted mb-1">Location</p>
                    <!-- Updated Location Display in Overview Tab -->
                    <p class="stat-value fw-bold h5">
                      {{ university.location || 'N/A' }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
        </li>

        <!-- Information Tab -->
        <li [ngbNavItem]="3">
          <button ngbNavLink>Information</button>
          <ng-template ngbNavContent>
            <div class="p-4">
              <h3 class="h5 fw-bold mb-3">Key Information</h3>

              <div class="info-group mb-4">
                <label class="text-muted small fw-semibold d-block mb-2">UNIVERSITY NAME</label>
                <p class="fw-bold mb-0">{{ university.name }}</p>
              </div>

              <div class="info-group mb-4">
                <label class="text-muted small fw-semibold d-block mb-2">LOCATION</label>
                <!-- Updated Location Display in Info Tab -->
                <p class="fw-bold mb-0">
                  {{ university.location || 'N/A' }}
                </p>
              </div>

              <div class="info-group mb-4">
                <label class="text-muted small fw-semibold d-block mb-2">ADDRESS</label>
                <p class="fw-bold mb-0">{{ university.address }}</p>
              </div>

              <div class="info-group mb-4">
                <label class="text-muted small fw-semibold d-block mb-2">CONTACT INFO</label>
                <p class="fw-bold mb-0">{{ university.contactInfo }}</p>
              </div>

              <div class="info-group mb-4">
                <label class="text-muted small fw-semibold d-block mb-2">WEBSITE</label>
                <p class="fw-bold mb-0">
                  @if (university.website !== 'N/A') {
                  <a [href]="university.website" target="_blank" rel="noopener noreferrer"
                    class="text-primary text-decoration-none">
                    {{ university.website }}
                    <i class="bi bi-box-arrow-up-right ms-1 small"></i>
                  </a>
                  } @else {
                  {{ university.website }}
                  }
                </p>
              </div>
            </div>
          </ng-template>
        </li>

        <!-- Courses Tab -->
        <li [ngbNavItem]="2">
          <button ngbNavLink>Courses</button>
          <ng-template ngbNavContent>
            <div class="p-4">
              <h3 class="h5 fw-bold mb-3">Featured Courses</h3>

              @if (university.courses && university.courses.length > 0) {
              <div class="courses-list">
                @for (course of university.courses; track course.id) {
                <div class="course-item d-flex gap-3 pb-3 mb-3 border-bottom" (click)="goToCourse(course.id)"
                  style="cursor: pointer;" role="button" tabindex="0">
                  <div class="flex-shrink-0">
                    <div class="course-icon bg-light rounded d-flex align-items-center justify-content-center">
                      <i class="bi bi-book-fill course-icon-inner"></i>
                    </div>
                  </div>

                  <div class="flex-grow-1">
                    <h5 class="fw-bold mb-0 fs-6">{{ course.name }}</h5>
                    <p class="mb-0 fw-semibold text-muted small">{{ course.area }}</p>
                  </div>
                </div>
                }
              </div>
              } @else {
              <p class="text-muted">No courses available</p>
              }
            </div>
          </ng-template>
        </li>


        <!-- Scholarships Tab -->
        <li [ngbNavItem]="5">
          <button ngbNavLink>Scholarships</button>
          <ng-template ngbNavContent>
            <div class="p-4">
              <h3 class="h5 fw-bold mb-3">Available Scholarships</h3>

              @if (university.scholarships && university.scholarships.length > 0) {
              <div class="scholarships-list">
                @for (scholarship of university.scholarships; track scholarship.id) {
                <div class="scholarship-item d-flex gap-3 pb-3 mb-3 border-bottom">
                  <div class="flex-shrink-0">
                    <div class="scholarship-icon bg-light rounded d-flex align-items-center justify-content-center">
                      <i class="bi bi-mortarboard-fill text-primary"></i>
                    </div>
                  </div>

                  <div class="flex-grow-1">
                    <h5 class="fw-bold mb-1 fs-6">{{ scholarship.name }}</h5>
                    <p class="mb-1 text-muted small">{{ scholarship.description }}</p>
                    <div class="d-flex gap-3 align-items-center">
                      <span class="badge" [ngClass]="{
                          'bg-info': scholarship.courseType?.toLowerCase() === 'bachelor',
                          'bg-warning': scholarship.courseType?.toLowerCase() === 'master',
                          'bg-danger': scholarship.courseType?.toLowerCase() === 'doctorate',
                          'bg-secondary': scholarship.courseType?.toLowerCase() !== 'bachelor' &&
                                         scholarship.courseType?.toLowerCase() !== 'master' &&
                                         scholarship.courseType?.toLowerCase() !== 'doctorate'
                        }">
                        {{ scholarship.courseType }}
                      </span>
                      <span class="fw-semibold text-success">${{ scholarship.amount | number }}</span>
                    </div>
                  </div>
                </div>
                }
              </div>
              } @else {
              <p class="text-muted">No scholarships available</p>
              }
            </div>
          </ng-template>
        </li>

        <!-- NEW: Reviews Tab -->
        <li [ngbNavItem]="4">
          <button ngbNavLink>Reviews</button>
          <ng-template ngbNavContent>
            <div class="p-4">
              <h3 class="h5 fw-bold mb-3">Student Reviews</h3>
              <!-- Pass the university ID to the reviews component -->
              <app-reviews [universityId]="university.id"></app-reviews>
            </div>
          </ng-template>
        </li>
      </ul>

      <!-- Tab Content Outlet -->
      <div [ngbNavOutlet]="nav" class="mt-2"></div>
    </div>
  </div>
</div>
}